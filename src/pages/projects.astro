---
import Layout from "../layouts/Layout.astro";
import Header from "../components/Header.astro";
import Footer from "../components/Footer.astro";
import ProjectCard from "../components/ProjectCard.astro";
import { type Locale } from "../i18n/config";
import { useTranslations } from "../i18n/utils";

const lang: Locale = "ko";
const t = useTranslations(lang);

const projects = [{ title: "Noise Flow Field", category: "WebGL", hue: 0 }];

const categories = [
    { name: t("projects.filter.all"), slug: "all" },
    { name: t("projects.filter.webgl"), slug: "webgl" },
    { name: t("projects.filter.interactive"), slug: "interactive" },
    { name: t("projects.filter.experiment"), slug: "experiment" },
];
---

<Layout
    title={t("nav.projects")}
    description="김종민의 크리에이티브 코딩 프로젝트. WebGL 실험, 인터랙티브 설치, 제너러티브 아트, 디지털 경험을 탐구합니다."
    keywords={[
        "projects",
        "portfolio",
        "webgl",
        "creative coding",
        "generative art",
        "interactive",
        "experiments",
    ]}
    lang={lang}
>
    <Header lang={lang} />
    <main
        class="w-full max-w-[var(--width-container-max)] mx-auto px-4 sm:px-6 lg:px-8 py-12 lg:py-16"
    >
        <!-- Header -->
        <div
            class="flex flex-col sm:flex-row justify-between items-start sm:items-center gap-4 mb-12 lg:mb-16"
        >
            <span class="label">{t("projects.title")}</span>
            <div class="flex flex-wrap gap-2" id="filter-buttons">
                {
                    categories.map((cat, index) => (
                        <button
                            class={`filter-btn ${index === 0 ? "active" : ""}`}
                            data-filter={cat.slug}
                        >
                            {cat.name}
                        </button>
                    ))
                }
            </div>
        </div>

        <!-- Projects Grid -->
        <div
            class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-8"
            id="projects-grid"
        >
            {
                projects.map((project, index) => (
                    <div
                        style={`animation-delay: ${index * 0.05}s`}
                        class="animate-fade-in opacity-0 project-item"
                        data-category={project.category.toLowerCase()}
                    >
                        <ProjectCard
                            title={project.title}
                            category={project.category}
                            hue={project.hue}
                        />
                    </div>
                ))
            }
        </div>
    </main>
    <Footer lang={lang} />
</Layout>

<script>
    const filterButtons = document.querySelectorAll(".filter-btn");
    const projectItems = document.querySelectorAll(".project-item");

    filterButtons.forEach((button) => {
        button.addEventListener("click", () => {
            const filter = button.getAttribute("data-filter");

            // Update active button
            filterButtons.forEach((btn) => btn.classList.remove("active"));
            button.classList.add("active");

            // Filter projects
            projectItems.forEach((item) => {
                const category = item.getAttribute("data-category");
                if (filter === "all" || category === filter) {
                    item.classList.remove("hidden");
                    (item as HTMLElement).style.animation =
                        "fadeIn 0.4s ease forwards";
                } else {
                    item.classList.add("hidden");
                }
            });
        });
    });
</script>
